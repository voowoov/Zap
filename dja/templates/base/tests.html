{% extends 'main.html' %}
{% load i18n %} {% load l10n %} {% load tz %} {% load static %}
{% block title %}{% trans "Test" %}{% endblock %}
{% block desc %}{% trans "" %}{% endblock %}
{% block content %}

<!-- /////////////////////////////////////////////////////////////////////////////////////////////////
                                    Tests  
/////////////////////////////////////////////////////////////////////////////////////////////////////-->

<main class="d-flex flex-fill">
  <section id=" testing_section" class="home_section text_color">
    <div class="searchboxmainjs" style="height: 40px; width:100%; background-color: gray;">
      <div class="h-100 d-flex flex-column align-items-center">
        <div class="mcenter">
          <div class="d-flex d-sm-none searchbtnback searchbtnround" type="button">
            <svg width="30" height="30">
              <use href="{% static '/images/icons/arrowb.svg' %}#img"></use>
            </svg>
          </div>
          <div class="searchboxctn1">
            <div class=" searchboxctn2">
              <input class="searchinputit" type="text" placeholder="{% trans "Search" %}" id="search-input"
                oninput="sendWebSocketMessage()" />
            </div>

            <div class="searchbtnenter" type="button">
              <svg width="18" height="18">
                <use href="{% static '/images/icons/search.svg' %}#img"></use>
              </svg>
            </div>
            <svg class="searchiconloupe" width="14" height="14">
              <use href="{% static '/images/icons/search.svg' %}#img"></use>
            </svg>
            <div class="searchbtnx searchbtnround" type="button">
              <svg width="20" height="20">
                <use href="{% static '/images/icons/x-lg.svg' %}#img"></use>
              </svg>
            </div>
          </div>
        </div>
        <div class="searchdropdownmenu">
          asdf
        </div>
      </div>
    </div>
  </section>
</main>

<script>
  var searchboxmainjs_list = document.getElementsByClassName('searchboxmainjs');
  for (var i = 0; i < searchboxmainjs_list.length; i++) {
    let searchboxmainjs = searchboxmainjs_list[i];
    // Fill the div with HTML code
    //searchboxmainjs.innerHTML = `
    //`;

    // For each one, get a second level of elements by class name within the iteration
    let searchinputit = searchboxmainjs_list[i].getElementsByClassName('searchinputit')[0];
    let searchiconloupe = searchboxmainjs_list[i].getElementsByClassName('searchiconloupe')[0];
    let searchbtnx = searchboxmainjs_list[i].getElementsByClassName('searchbtnx')[0];
    let searchbtnenter = searchboxmainjs_list[i].getElementsByClassName('searchbtnenter')[0];
    let searchbtnback = searchboxmainjs_list[i].getElementsByClassName('searchbtnback')[0];
    let searchboxctn2 = searchboxmainjs_list[i].getElementsByClassName('searchboxctn2')[0];
    let searchdropdownmenu = searchboxmainjs_list[i].getElementsByClassName('searchdropdownmenu')[0];

    // Add an event listener for input changes
    searchinputit.addEventListener("input", function () {
      // Unhide searchbtnx if there is text inside the input field
      if (this.value !== "") {
        searchbtnx.style.display = "flex";
      } else {
        // Hide searchbtnx if the input field is empty
        searchbtnx.style.display = "none";
      }
    });

    searchbtnx.addEventListener("mousedown", function () {
      // Prevent the button from taking focus
      event.preventDefault();
    });
    searchbtnx.addEventListener("mouseup", function () {
      // Empty the input element
      searchinputit.value = "";
      // Set the focus on the input element
      searchinputit.focus();
      searchinputit.dispatchEvent(new MouseEvent('mousedown'));
    });

    searchinputit.addEventListener('mousedown', function () {
      // Unhide searchbtnx if there is text inside the input field
      if (this.value !== "") {
        searchbtnx.style.display = "flex";
      }

      if (window.getComputedStyle(searchdropdownmenu).display === 'none') {
        searchiconloupe.style.display = "block";
        searchdropdownmenu.style.display = 'block';
        searchboxctn2.style.marginLeft = '0';
        searchboxctn2.style.paddingLeft = '25px';
        searchboxctn2.style.border = '1px solid var(--searchborderselectcolor)';
      }

      function handleClick(event) {
        if (!searchboxctn2.contains(event.target) && !
          searchdropdownmenu.contains(event.target)) {
          console.log('jyt');
          // The click occurred outside of both elements
          searchiconloupe.style.display = "none";
          searchdropdownmenu.style.display = 'none';
          searchboxctn2.style.marginLeft = '25px';
          searchboxctn2.style.paddingLeft = '0';
          searchboxctn2.style.border = '1px solid var(--searchbuttoncolor)';
          document.removeEventListener('mousedown', handleClick);
        }
      }
      document.addEventListener('mousedown', handleClick);
    });

    searchboxctn2.addEventListener('mousedown', function (event) {
      if (event.target !== searchinputit) {
        event.preventDefault();
      }
    });


    searchbtnenter.addEventListener("click", function () {
      console.log('asdf');
    });

    searchbtnback.addEventListener("click", function () {
      searchboxmainjs.style.display = 'none';
    });

  }
</script>


{% comment %} {% include 'base/footers/footer_small.html' %} {% endcomment %}
{% include 'base/footers/footer_small.html' %}



{% endblock %}