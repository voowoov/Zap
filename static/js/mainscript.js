/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "../cjs/base.js":
/*!**********************!*\
  !*** ../cjs/base.js ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   throttle: () => (/* binding */ throttle)\n/* harmony export */ });\n(function() {\r\n  let element = document.getElementById('your-id');\r\n  if (element) {\r\n    // Your code here\r\n  };\r\n})();\r\n\r\n/////////////////////////////////////////////////////////////////////////////////\r\n// Determine dark or light theme for raster images\r\n/////////////////////////////////////////////////////////////////////////////////\r\n(function() {\r\n  let theme = \"\";\r\n  //local storage is used to override OS theme settings\r\n  switch (getCookie(\"theme\")) {\r\n    case \"light\":\r\n      document.getElementById(\"jsddnavthemelight\").classList.add(\"disabled\");\r\n      break;\r\n    case \"dark\":\r\n      theme = \"dark\";\r\n      document.getElementById(\"jsddnavthemedark\").classList.add(\"disabled\");\r\n      break;\r\n    case \"Auto\":\r\n      document.getElementById(\"jsddnavthemeauto\").classList.add(\"disabled\");\r\n      break;\r\n    case \"\":\r\n      if (!window.matchMedia) {\r\n        return false;\r\n      } else if (window.matchMedia(\"(prefers-color-scheme: dark)\").matches) {\r\n        //OS theme setting detected as dark\r\n        theme = \"dark\";\r\n      };\r\n      document.getElementById(\"jsddnavthemeauto\").classList.add(\"disabled\");\r\n      break;\r\n    default:\r\n  }\r\n  if (theme == \"dark\") {\r\n    document.querySelectorAll('.Logo1Light').forEach(function(element) {\r\n      element.style.display = 'none';\r\n    });\r\n    document.querySelectorAll('.Logo1Dark').forEach(function(element) {\r\n      element.style.display = 'block';\r\n    });\r\n  }\r\n})();\r\n\r\n/////////////////////////////////////////////////////////////////////////////////\r\n// Get page language from html header\r\n/////////////////////////////////////////////////////////////////////////////////\r\nconst pageLanguage = document.documentElement.lang;\r\n\r\n/////////////////////////////////////////////////////////////////////////////////\r\n// Button toggle container display\r\n// Parent class  toggleDisplayCtnWithBtn, childs  toggleDisplayCtn and toggleDisplayBtn\r\n/////////////////////////////////////////////////////////////////////////////////\r\n(function() {\r\n  const toggleDisplayCtnWithBtn_List = document.querySelectorAll(\".toggleDisplayCtnWithBtn\");\r\n  if (toggleDisplayCtnWithBtn_List) {\r\n    for (let item of toggleDisplayCtnWithBtn_List) {\r\n      const toggleDisplayCtn = item.querySelector(\".toggleDisplayCtn\");\r\n      const toggleDisplayBtn = item.querySelector(\".toggleDisplayBtn\");\r\n      if (toggleDisplayBtn !== null && toggleDisplayCtn !== null) {\r\n        toggleDisplayBtn.addEventListener('click', throttle(function() {\r\n          if (toggleDisplayCtn.style.display !== \"none\") {\r\n            toggleDisplayCtn.style.display = \"none\";\r\n          } else {\r\n            toggleDisplayCtn.style.display = \"block\";\r\n          }\r\n        }, 1000));\r\n      };\r\n    };\r\n  };\r\n})();\r\n\r\n\r\n/////////////////////////////////////////////////////////////////////////////////\r\n// Keep horizontal scroll to the right in tables\r\n/////////////////////////////////////////////////////////////////////////////////\r\n(function() {\r\n  const tableScrollRight_Lists = document.querySelectorAll(\".tableScrollRight\");\r\n  if (tableScrollRight_Lists.length > 0) {\r\n    function setTableScrollRight() {\r\n      for (let i = 0; i < tableScrollRight_Lists.length; i++) {\r\n        tableScrollRight_Lists[i].scrollLeft = tableScrollRight_Lists[i].scrollWidth;\r\n      };\r\n    };\r\n    setTableScrollRight();\r\n    window.addEventListener('resize', function() {\r\n      setTableScrollRight();\r\n    });\r\n  };\r\n})();\r\n\r\n\r\n/////////////////////////////////////////////////////////////////////////////////\r\n// Make entire table row a link\r\n/////////////////////////////////////////////////////////////////////////////////\r\n(function() {\r\n  let rows = document.querySelectorAll('entireTableRowIsLink');\r\n  if (rows) {\r\n    rows.forEach(function(row) {\r\n      row.addEventListener('click', throttle(function() {\r\n        window.location.href = row.getAttribute('data-href');\r\n      }, 1000));\r\n    });\r\n  };\r\n})();\r\n\r\n\r\n/////////////////////////////////////////////////////////////////////////////////\r\n// Cookie functions\r\n/////////////////////////////////////////////////////////////////////////////////\r\n\r\nfunction setCookie(cname, cvalue, exdays) {\r\n  const d = new Date();\r\n  d.setTime(d.getTime() + (exdays * 86400000));\r\n  let expires = \"expires=\" + d.toUTCString();\r\n  document.cookie = cname + \"=\" + cvalue + \";\" + expires + \";path=/\";\r\n};\r\n\r\nfunction getCookie(cname) {\r\n  let name = cname + \"=\";\r\n  let ca = document.cookie.split(';');\r\n  for (let i = 0; i < ca.length; i++) {\r\n    let c = ca[i];\r\n    while (c.charAt(0) == ' ') {\r\n      c = c.substring(1);\r\n    };\r\n    if (c.indexOf(name) == 0) {\r\n      return c.substring(name.length, c.length);\r\n    };\r\n  };\r\n  return \"\";\r\n};\r\n\r\n/////////////////////////////////////////////////////////////////////////////////\r\n// Cookie banner and custom options\r\n/////////////////////////////////////////////////////////////////////////////////\r\n(function() {\r\n  const cookiesBannerDiv = document.getElementById(\"cookiesBannerDiv\");\r\n  if (cookiesBannerDiv) {\r\n    function closeCookieBanner() {\r\n      if (cookiesBannerDiv.style.display !== \"none\") {\r\n        cookiesBannerDiv.style.display = \"none\";\r\n      } else {\r\n        cookiesBannerDiv.style.display = \"block\";\r\n      };\r\n    };\r\n    document.getElementById(\"cookiesAcceptAllBtn\").addEventListener('click', throttle(function() {\r\n      setCookie(\"cookie_pref\", \"111\", 120);\r\n      closeCookieBanner();\r\n    }, 1000));\r\n    // Cookie custom options\r\n    document.getElementById(\"cookiesCustomAllBtn\").addEventListener('click', throttle(function() {\r\n      setCookie(\"cookie_pref\", \"111\", 120);\r\n      closeCookieBanner();\r\n    }, 1000));\r\n    document.getElementById(\"cookiesCustomOptBtn\").addEventListener('click', throttle(function() {\r\n      let cookiePrefTemp = (document.getElementById(\"switchCookie2\").checked) ? '1' : '0';\r\n      cookiePrefTemp += (document.getElementById(\"switchCookie3\").checked) ? '1' : '0';\r\n      cookiePrefTemp += (document.getElementById(\"switchCookie4\").checked) ? '1' : '0';\r\n      setCookie(\"cookie_pref\", cookiePrefTemp, 120);\r\n      closeCookieBanner();\r\n    }, 1000));\r\n  };\r\n})();\r\n// Cookie banner\r\n\r\n\r\n/////////////////////////////////////////////////////////////////////////////////\r\n// Back-to-top button functions\r\n/////////////////////////////////////////////////////////////////////////////////\r\n(function() {\r\n  let btnBackToTop = document.querySelector('.btnBackToTop');\r\n  if (btnBackToTop) {\r\n    window.onscroll = function() {\r\n      scrollTresholdDetectFunction();\r\n    };\r\n\r\n    function scrollTresholdDetectFunction() {\r\n      let scroolTrigger = 200;\r\n      if (document.body.scrollTop > scroolTrigger || document.documentElement.scrollTop > scroolTrigger) {\r\n        btnBackToTop.style.opacity = '0.85';\r\n      } else {\r\n        btnBackToTop.style.opacity = '0';\r\n      };\r\n    };\r\n    btnBackToTop.addEventListener('click', throttle(function() {\r\n      window.scrollTo({\r\n        left: 0,\r\n        top: 0,\r\n        behavior: \"smooth\"\r\n      });\r\n    }, 1000));\r\n  };\r\n})();\r\n\r\n\r\n/////////////////////////////////////////////////////////////////////////////////\r\n//    navbar swipe link string with touch, mouse wheel or drag\r\n/////////////////////////////////////////////////////////////////////////////////\r\n(function() {\r\n  const navbarSwipeMenu = document.querySelector('.navlinkbarswipe');\r\n  if (navbarSwipeMenu) {\r\n    navbarSwipeMenu.addEventListener(\"wheel\", event => {\r\n      event.preventDefault();\r\n      navbarSwipeMenu.scrollLeft += event.deltaY / 5;\r\n    });\r\n\r\n    // mouse click-drag-release scroll horizontally\r\n    navbarSwipeMenu.addEventListener(\"mousedown\", event => {\r\n      let preventClickTreshold = false;\r\n      let navswipeStartPosition = event.clientX;\r\n      let navswipeStartScrollLeft = navbarSwipeMenu.scrollLeft;\r\n\r\n      function handleNavSwipeMousemove(event) {\r\n        const displacementInPixels = navswipeStartPosition - event.clientX;\r\n        navbarSwipeMenu.scrollLeft = navswipeStartScrollLeft + displacementInPixels;\r\n        if (Math.abs(displacementInPixels) > 2) {\r\n          preventClickTreshold = true;\r\n        }\r\n      }\r\n      document.addEventListener(\"mousemove\", handleNavSwipeMousemove);\r\n\r\n      function handlePreventLinkClick(event) {\r\n        if (preventClickTreshold) {\r\n          event.preventDefault();\r\n        }\r\n      }\r\n      navbarSwipeMenu.addEventListener(\"click\", throttle(handlePreventLinkClick, 1000));\r\n\r\n      function handleNavSwipeMouseup(event) {\r\n        setTimeout(function() {\r\n          document.removeEventListener(\"mousemove\", handleNavSwipeMousemove);\r\n          document.removeEventListener(\"mouseup\", handleNavSwipeMouseup);\r\n          navbarSwipeMenu.removeEventListener(\"click\", handlePreventLinkClick);\r\n        }, 0);\r\n      }\r\n      document.addEventListener(\"mouseup\", handleNavSwipeMouseup);\r\n    });\r\n  };\r\n})();\r\n\r\n/////////////////////////////////////////////////////////////////////////////////\r\n//\r\n/////////////////////////////////////////////////////////////////////////////////\r\n\r\n\r\n/////////////////////////////////////////////////////////////////////////////////\r\n//\r\n/////////////////////////////////////////////////////////////////////////////////\r\n\r\n\r\n/////////////////////////////////////////////////////////////////////////////////\r\n//  close open bs dropdown menus with escape key\r\n/////////////////////////////////////////////////////////////////////////////////\r\nwindow.addEventListener('keydown', function(event) {\r\n  if (event.key === 'Escape') {\r\n    // Get all shown dropdown elements\r\n    const dropdowns = document.querySelectorAll('.dropdown-menu.show');\r\n    // Loop through each dropdown and remove the 'show' class\r\n    for (let i = 0; i < dropdowns.length; i++) {\r\n      dropdowns[i].classList.remove('show');\r\n      // Get the button that controls this dropdown\r\n      const button = dropdowns[i].parentNode.querySelector('[aria-expanded]');\r\n      if (button) {\r\n        // Set 'aria-expanded' to 'false'\r\n        button.setAttribute('aria-expanded', 'false');\r\n      };\r\n    };\r\n  };\r\n});\r\n\r\n\r\n/////////////////////////////////////////////////////////////////////////////////\r\n//\r\n/////////////////////////////////////////////////////////////////////////////////\r\nfunction throttle(func, delay) {\r\n  let lastCall = 0;\r\n  return function(...args) {\r\n    const now = Date.now();\r\n    if (now - lastCall < delay) { return; }\r\n    lastCall = now;\r\n    return func.apply(this, args);\r\n  };\r\n}\n\n//# sourceURL=webpack://zap/../cjs/base.js?");

/***/ }),

/***/ "../cjs/filespro.js":
/*!**************************!*\
  !*** ../cjs/filespro.js ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ setupWsiFileUpload)\n/* harmony export */ });\n/* harmony import */ var _wsi_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./wsi.js */ \"../cjs/wsi.js\");\n/* harmony import */ var _base_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./base.js */ \"../cjs/base.js\");\n\r\n\r\n\r\n\r\n\r\n\r\n/////////////////////////////////////////////////////////////////////////////////\r\n//  File uploads\r\n/////////////////////////////////////////////////////////////////////////////////\r\n\r\nfunction setupWsiFileUpload() {\r\n  console.log('filespro module enabled');\r\n  const pageLanguage = document.documentElement.lang;\r\n\r\n  /////////////////////////////////////////////////////////////////////////////////\r\n  // could be already open\r\n  /////////////////////////////////////////////////////////////////////////////////\r\n  setTimeout(function() {\r\n    (0,_wsi_js__WEBPACK_IMPORTED_MODULE_0__.wsiOpenOrAccessSharedSocket)();\r\n    if (fileUploadList) { askForListOfFiles(); }\r\n  }, 0);\r\n\r\n  const fileChunkSize = 1990; // Size of chunks\r\n  const fileMaxNbChunks = 100;\r\n  const fileMaxSize = 10000000;\r\n\r\n  const filePartialSize = fileChunkSize * fileMaxNbChunks; // Size of chunks\r\n  let transferUnderway = false\r\n  let filePortionStep = 0;\r\n  let filePortionsArray = [];\r\n  let fileUploadName;\r\n  let fileA = new File([\"\"], \"\");\r\n\r\n  const fileUploadList = document.querySelector('.fileUploadList');\r\n  const fileUploadRealInput = document.querySelector('.fileUploadRealInput');\r\n  const fileUploadChooseBtn = document.querySelector('.fileUploadChooseBtn');\r\n  const fileUploadChoiceTxt = document.querySelector('.fileUploadChoiceTxt');\r\n  const fileUploadSendBtn = document.querySelector('.fileUploadSendBtn');\r\n  const fileUploadCancelBtn = document.querySelector('.fileUploadCancelBtn');\r\n  const fileUploadLogTxt = document.querySelector('.fileUploadLogTxt');\r\n\r\n  function wsiToFilesproMessageReceived(message) {\r\n    let message_ = message.substring(1)\r\n    switch (message[0]) {\r\n      case 'u':\r\n        if (fileUploadList) { updateListOfFilesFromJson(message_); };\r\n        break;\r\n      case 'a':\r\n        sendFilePartialUpload();\r\n        break;\r\n      case 'r':\r\n        receivedConfirmationSuccessfull(message_);\r\n        break;\r\n      case 'e':\r\n        errorFileUpload(message_);\r\n        break;\r\n    };\r\n  };\r\n\r\n  if (fileUploadSendBtn) {\r\n    fileUploadChooseBtn.addEventListener('click', (0,_base_js__WEBPACK_IMPORTED_MODULE_1__.throttle)(function() {\r\n      fileUploadRealInput.click();\r\n    }, 1000));\r\n    fileUploadRealInput.addEventListener('change', function() {\r\n      fileA = fileUploadRealInput.files[0];\r\n      updateFileUploadChoiceTxt();\r\n    });\r\n    fileUploadSendBtn.addEventListener('click', (0,_base_js__WEBPACK_IMPORTED_MODULE_1__.throttle)(function() {\r\n      sendFileWsi(\"manual\");\r\n    }, 1000));\r\n    fileUploadCancelBtn.addEventListener('click', (0,_base_js__WEBPACK_IMPORTED_MODULE_1__.throttle)(function() {\r\n      if (transferUnderway) {\r\n        transferUnderway = false\r\n        fileUploadLog('\\u2716 ' + (pageLanguage == \"fr\" ? \"Envoie du fichier cancellé.\" : \"Sending file was canceled.\"));\r\n        fileUploadChooseBtn.disabled = false;\r\n        fileUploadSendBtn.disabled = false;\r\n        fileUploadCancelBtn.disabled = false;\r\n        filePortionStep = 0;\r\n        (0,_wsi_js__WEBPACK_IMPORTED_MODULE_0__.wsiSend)('f' + _wsi_js__WEBPACK_IMPORTED_MODULE_0__.wsiCurrentTabId + \"c\");\r\n      } else {\r\n        fileUploadLog(\"\");\r\n        clearSelectionFileUpload();\r\n      };\r\n    }, 1500));\r\n  };\r\n\r\n  function fileUploadLog(log_str) {\r\n    if (fileUploadLogTxt) {\r\n      fileUploadLogTxt.innerHTML = log_str;\r\n    };\r\n    console.log(log_str);\r\n  };\r\n\r\n  function updateFileUploadChoiceTxt() {\r\n    if (fileUploadRealInput.value) {\r\n      if (validate_file()) {\r\n        fileUploadChoiceTxt.innerHTML = fileA.name;\r\n        fileUploadSendBtn.disabled = false;\r\n        fileUploadCancelBtn.disabled = false;\r\n        fileUploadLog('\\uD83D\\uDCC4 ' + (pageLanguage == \"fr\" ? \"Fichier sélectionné.\" : \"File selected.\"));\r\n      };\r\n    } else {\r\n      fileUploadChoiceTxt.innerHTML = pageLanguage == \"fr\" ? \"Pas de fichier choisi.\" : \"No file chosen, yet!.\";\r\n      fileUploadChooseBtn.disabled = false;\r\n      fileUploadSendBtn.disabled = true;\r\n      fileUploadCancelBtn.disabled = true;\r\n    };\r\n  };\r\n  if (fileUploadRealInput) { updateFileUploadChoiceTxt(); }\r\n\r\n  function validate_file() {\r\n    if (isValidFilename(fileA.name)) {\r\n      if (fileA.size < fileMaxSize) {\r\n        return true;\r\n      } else {\r\n        fileUploadLog('\\u26A0 ' + (pageLanguage == \"fr\" ? \"Le fichier est trop large.\" : \"File size is too large.\"));\r\n      };\r\n    } else {\r\n      fileUploadLog('\\u26A0 ' + (pageLanguage == \"fr\" ? \"Nom de fichier invalide.\" : \"Invalid file name.\"));\r\n    };\r\n    return false;\r\n  };\r\n\r\n  function isValidFilename(filename) {\r\n    // Check total length\r\n    if (filename.length > 255) return false;\r\n    // Check extension length\r\n    let parts = filename.split(\".\");\r\n    if (parts.length < 2 || parts[parts.length - 1].length < 2 || parts[parts.length - 1].length > 7) return false;\r\n    // Check invalid characters\r\n    let invalidChars = /[<>:\"/\\\\|?*]/;\r\n    if (invalidChars.test(filename)) return false;\r\n    // Check for trailing spaces or periods\r\n    if (filename[filename.length - 1] === \" \" || filename[filename.length - 1] === \".\") return false;\r\n    // Check for non-printable characters\r\n    if (/[\\x00-\\x1F\\x80-\\x9F]/.test(filename)) return false;\r\n    return true;\r\n  }\r\n\r\n  function errorFileUpload(strError) {\r\n    switch (strError) {\r\n      case 'file already exists':\r\n        fileUploadLog('\\u26A0 ' + (pageLanguage == \"fr\" ? \"Le fichier est déjà partagé.\" : \"The file is already shared.\"));\r\n        break;\r\n      case 'insufficient remaining space':\r\n        fileUploadLog('\\u26A0 ' + (pageLanguage == \"fr\" ? \"Espace insuffisant.\" : \"Insufficient space.\"));\r\n        break;\r\n      case 'wait a cooldown period':\r\n        fileUploadLog('\\u26A0 ' + (pageLanguage == \"fr\" ? \"Veuillez essayer plus tard.\" : \"Please try again later.\"));\r\n        break;\r\n      default:\r\n        fileUploadLog('\\u26A0 ' + (pageLanguage == \"fr\" ? \"Erreur en envoyant le fichier.\" : \"Error while sending file.\"));\r\n    }\r\n    if (fileUploadSendBtn) {\r\n      fileUploadChooseBtn.disabled = false;\r\n      fileUploadSendBtn.disabled = false;\r\n    };\r\n    filePortionStep = 0;\r\n    transferUnderway = false;\r\n  };\r\n\r\n  function clearSelectionFileUpload() {\r\n    if (fileUploadSendBtn) {\r\n      fileUploadRealInput.value = \"\";\r\n      updateFileUploadChoiceTxt();\r\n    };\r\n    filePortionStep = 0;\r\n    transferUnderway = false;\r\n  };\r\n\r\n  function sendFileWsi(upload_type) {\r\n    if (validate_file()) {\r\n      if (fileUploadSendBtn) {\r\n        fileUploadChooseBtn.disabled = true;\r\n        fileUploadSendBtn.disabled = true;\r\n      };\r\n      fileUploadName = fileA.name;\r\n      filePortionStep = 0;\r\n      filePortionsArray = dividePortionsArray();\r\n      transferUnderway = true;\r\n      (0,_wsi_js__WEBPACK_IMPORTED_MODULE_0__.wsiSend)('f' + _wsi_js__WEBPACK_IMPORTED_MODULE_0__.wsiCurrentTabId + 's' + JSON.stringify({ upload_type: upload_type, file_name: fileA.name, file_size: fileA.size }));\r\n    };\r\n  };\r\n\r\n  function sendFilePartialUpload() {\r\n    try {\r\n      if (transferUnderway) {\r\n        let chunksNb = Math.ceil(filePortionsArray[filePortionStep][2] / fileChunkSize); // Number of chunks\r\n        let chunkId = 0; // Start with the first chunk\r\n        let percentage = Math.floor(filePortionStep / filePortionsArray.length * 100).toString() + ' %';\r\n        fileUploadLog('\\u231B ' + (pageLanguage == \"fr\" ? \"Envoie du fichier en cours.\" : \"Sending file in progress.\"));\r\n\r\n        function readNextChunk() {\r\n          return new Promise((resolve, reject) => {\r\n            if (chunkId < chunksNb && transferUnderway) {\r\n              let start = filePortionsArray[filePortionStep][0] + chunkId * fileChunkSize;\r\n              let end = Math.min(start + fileChunkSize, filePortionsArray[filePortionStep][1] + 1);\r\n              let blob = fileA.slice(start, end); // Create a blob representing the chunk\r\n              let reader = new FileReader();\r\n              reader.onloadend = function(evt) {\r\n                if (evt.target.readyState == FileReader.DONE) { // When the chunk is read\r\n                  // make the byte array with [Chunk id (4 bytes int) + File byte array (rest of the bytes)]\r\n                  let buffer = new ArrayBuffer(4),\r\n                    view = new DataView(buffer);\r\n                  view.setInt32(0, chunkId, true);\r\n                  let resultByteLength = evt.target.result.byteLength,\r\n                    arrayBuffer = new Uint8Array(view.byteLength + resultByteLength);\r\n                  arrayBuffer.set(new Uint8Array(view.buffer));\r\n                  arrayBuffer.set(new Uint8Array(evt.target.result), view.byteLength);\r\n                  (0,_wsi_js__WEBPACK_IMPORTED_MODULE_0__.wsiSend)(arrayBuffer);\r\n                  chunkId++;\r\n                  resolve(readNextChunk()); // Resolve the promise with the next recursive call\r\n                }\r\n              };\r\n              reader.readAsArrayBuffer(blob);\r\n            } else {\r\n              resolve(); // Resolve the promise when there are no more chunks to read\r\n            };\r\n          });\r\n        };\r\n        readNextChunk().then(() => {\r\n          if (filePortionStep == filePortionsArray.length - 1) {\r\n            transferUnderway = false;\r\n          } else {\r\n            filePortionStep++;\r\n          };\r\n        });\r\n      };\r\n    } catch (error) {\r\n      console.error(error);\r\n    };\r\n  };\r\n\r\n\r\n  // sets a 2d Array with start position, end position and length for each portion of the file\r\n  // ex 10 and 3 will output  [[0, 2, 3], [3, 5, 3], [6, 8, 3], [9, 9, 1]]\r\n  function dividePortionsArray() {\r\n    let quotient = Math.floor(fileA.size / filePartialSize);\r\n    let remainder = fileA.size % filePartialSize;\r\n    let start = 0;\r\n    let portions = [];\r\n    for (let i = 0; i < quotient; i++) {\r\n      let end = start + filePartialSize;\r\n      portions.push([start, end - 1, filePartialSize]);\r\n      start = end;\r\n    };\r\n    if (remainder != 0) {\r\n      portions.push([start, start + remainder - 1, remainder]);\r\n    };\r\n    return portions;\r\n  };\r\n\r\n  function receivedConfirmationSuccessfull(message) {\r\n    if (avatar) { avatar.resetInterface(message) };\r\n    if (fileUploadList) { askForListOfFiles() };\r\n    fileUploadLog('\\u2713 ' + (pageLanguage == \"fr\" ? \"Envoie réeussi de: \" : \"Sent successfully: \") + fileUploadName);\r\n    clearSelectionFileUpload();\r\n  };\r\n\r\n  function askForListOfFiles() {\r\n    try {\r\n      (0,_wsi_js__WEBPACK_IMPORTED_MODULE_0__.wsiSend)('f' + _wsi_js__WEBPACK_IMPORTED_MODULE_0__.wsiCurrentTabId + \"u\" + pageLanguage);\r\n    } catch (error) {\r\n      // console.error(error);\r\n    };\r\n  };\r\n\r\n  function updateListOfFilesFromJson(data) {\r\n    let fileMetaList = JSON.parse(data);\r\n    let result = ``;\r\n    let title_download, title_viewer;\r\n    if (pageLanguage == \"fr\") {\r\n      title_download = \"Télécharger\";\r\n      title_viewer = \"Ouvrir dans un nouvel onglet\"\r\n    } else {\r\n      title_download = \"Download\"\r\n      title_viewer = \"Open in a new tab\"\r\n    };\r\n    for (let i = 0; i < fileMetaList.length; i++) {\r\n      let element = fileMetaList[i];\r\n      // Assuming the keys you're interested in are 'key1' and 'key2'\r\n      if ('file_name' in element && 'view' in element && 'dnld' in element) {\r\n        result += `    <div class=\"d-flex p-0 file_choice_row\">\r\n        <div class=\"d-flex justify-content-center align-items-center flex-shrink-0\" style=\"width: 30px;\">&#x1F5CE;</div>\r\n        <div class=\"flex-grow-1 file_name_div\">`\r\n        if (element['view'].length > 0) {\r\n          result += `<a class=\"text_color file_name_long\" href=\"${element['view']}\" draggable=\"false\" title=\"${title_viewer}\" target=\"_blank\">\r\n            ${element['file_name']}\r\n          </a>`\r\n        } else {\r\n          result += `<div class=\"file_name_long\">\r\n            ${element['file_name']}\r\n          </div>`\r\n        }\r\n        result += `</div>\r\n        <div class=\"d-flex justify-content-center align-items-center flex-shrink-0\" style=\"width: 40px;\">\r\n          <a class=\"file_download_button\" href=\"${element['dnld']}\" draggable=\"false\" title=\"${title_download}\" target=\"_blank\"> &#x2935;</a>\r\n        </div>\r\n        </div>`;\r\n      }\r\n    }\r\n    fileUploadList.innerHTML = result;\r\n  };\r\n\r\n\r\n  /////////////////////////////////////////////////////////////////////////////////\r\n  //  Avatar functions\r\n  /////////////////////////////////////////////////////////////////////////////////\r\n  const fileUploadSendAvatarBtn = document.querySelector('.fileUploadSendAvatarBtn');\r\n  if (fileUploadSendAvatarBtn) {\r\n    var avatar = setupAvatar()\r\n  };\r\n\r\n  function setupAvatar() {\r\n    const imageViewerFileChooseBtn = document.querySelector('.imageViewerFileChooseBtn');\r\n    const imageViewerInitialImage = document.querySelector('.imageViewerInitialImage');\r\n\r\n    // Send the result avatar using filespro\r\n    fileUploadSendAvatarBtn.addEventListener('click', (0,_base_js__WEBPACK_IMPORTED_MODULE_1__.throttle)(function() {\r\n      const canvas = document.querySelector('.image_viewer_canvas');\r\n      let imgsrc = canvas.toDataURL(\"image/png\");\r\n      let blob = dataURLtoBlob(imgsrc);\r\n      fileA = new File([blob], 'avatar.png', {\r\n        type: \"image/png\",\r\n        lastModified: new Date(),\r\n      });\r\n      console.log('file size', fileA.size);\r\n      fileUploadSendAvatarBtn.disabled = true\r\n      imageViewerFileChooseBtn.disabled = true;\r\n      sendFileWsi(\"avatar\");\r\n    }, 1000));\r\n\r\n    function dataURLtoBlob(dataurl) {\r\n      let arr = dataurl.split(','),\r\n        mime = arr[0].match(/:(.*?);/)[1],\r\n        bstr = atob(arr[1]),\r\n        n = bstr.length,\r\n        u8arr = new Uint8Array(n);\r\n      while (n--) {\r\n        u8arr[n] = bstr.charCodeAt(n);\r\n      }\r\n      return new Blob([u8arr], {\r\n        type: mime\r\n      });\r\n    };\r\n\r\n    function resetInterface(message) {\r\n      imageViewerInitialImage.src = message;\r\n      imageViewerInitialImage.hidden = false;\r\n      imageViewerFileChooseBtn.disabled = false;\r\n    };\r\n    return {\r\n      resetInterface: resetInterface,\r\n    };\r\n  };\r\n\r\n  return {\r\n    askForListOfFiles: askForListOfFiles,\r\n    wsiToFilesproMessageReceived: wsiToFilesproMessageReceived,\r\n  };\r\n};\n\n//# sourceURL=webpack://zap/../cjs/filespro.js?");

/***/ }),

/***/ "../cjs/search.js":
/*!************************!*\
  !*** ../cjs/search.js ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ setupWsiSearch)\n/* harmony export */ });\n/* harmony import */ var _wsi_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./wsi.js */ \"../cjs/wsi.js\");\n/* harmony import */ var _base_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./base.js */ \"../cjs/base.js\");\n\r\n\r\n\r\n/////////////////////////////////////////////////////////////////////////////////\r\n//  Search\r\n/////////////////////////////////////////////////////////////////////////////////\r\n\r\nfunction setupWsiSearch() {\r\n  const pageLanguage = document.documentElement.lang;\r\n\r\n  let screenWidthLg = 992; // Replace with your value\r\n  let navSearchStartTimer;\r\n\r\n  /////////////////////////////////////////////////////////////////////////////////\r\n  //  HTML code for search\r\n  /////////////////////////////////////////////////////////////////////////////////\r\n  let navSearchPlaceHolder;\r\n  navSearchPlaceHolder = pageLanguage == \"fr\" ? \"Rechercher\" : \"Search\"\r\n  const navSearchMain = document.querySelector('.navSearchMain');\r\n  navSearchMain.innerHTML = `\r\n  <div class=\"d-flex flex-column align-items-center text_color\">\r\n    <div class=\"navSearchBoxDiv0\">\r\n      <div class=\"d-flex d-sm-none navSearchBtnBack navSearchBtnRound\" type=\"button\">\r\n        <svg width=\"30\" height=\"30\">\r\n          <use href=\"/static/images/icons/arrowb.svg#img\"></use>\r\n        </svg>\r\n      </div>\r\n      <div class=\"navSearchBoxDiv1\">\r\n        <div class=\" navSearchBoxDiv2\">\r\n          <input class=\"navSearchInputTxt\" name=\"search_field\" type=\"text\" placeholder=\"${navSearchPlaceHolder}\" maxlength=\"50\"/>\r\n        </div>\r\n        <div class=\"navSearchBtnEnter\" type=\"button\">\r\n          <svg width=\"18\" height=\"18\">\r\n            <use href=\"/static/images/icons/search.svg#img\"></use>\r\n          </svg>\r\n        </div>\r\n        <svg class=\"navSearchIconLoupe\" width=\"14\" height=\"14\">\r\n          <use href=\"/static/images/icons/search.svg#img\"></use>\r\n        </svg>\r\n        <div class=\"navSearchBtnClearX navSearchBtnRound\" type=\"button\">\r\n          <svg width=\"20\" height=\"20\">\r\n            <use href=\"/static/images/icons/x-lg.svg#img\"></use>\r\n          </svg>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"navSearchResDiv0\">\r\n    </div>\r\n  </div>`;\r\n\r\n  const navSearchTriggerBtn = document.querySelector('.btn_nav__search');\r\n  const navSearchInputTxt = navSearchMain.querySelector('.navSearchInputTxt');\r\n  const navSearchIconLoupe = navSearchMain.querySelector('.navSearchIconLoupe');\r\n  const navSearchBtnClearX = navSearchMain.querySelector('.navSearchBtnClearX');\r\n  const navSearchBtnEnter = navSearchMain.querySelector('.navSearchBtnEnter');\r\n  const navSearchBtnBack = navSearchMain.querySelector('.navSearchBtnBack');\r\n  const navSearchBoxDiv2 = navSearchMain.querySelector('.navSearchBoxDiv2');\r\n  const navSearchResDiv0 = navSearchMain.querySelector('.navSearchResDiv0');\r\n\r\n  /////////////////////////////////////////////////////////////////////////////////\r\n  //  Hide and Show search controls and results\r\n  /////////////////////////////////////////////////////////////////////////////////\r\n  function showSearchControl() {\r\n    navSearchIconLoupe.style.display = \"block\";\r\n    navSearchBoxDiv2.style.marginLeft = '0';\r\n    navSearchBoxDiv2.style.paddingLeft = '25px';\r\n    navSearchBoxDiv2.style.border = '1px solid var(--color-searchborderselect)';\r\n    navSearchResDiv0.style.display = 'block';\r\n    if (!window.matchMedia('(min-width: ' + screenWidthLg + 'px)').matches) {\r\n      navSearchMain.style.display = \"block\";\r\n    };\r\n    navSearchInputTxt.focus();\r\n    navSearchTriggerBtn.setAttribute('aria-expanded', 'true');\r\n\r\n    // hide the main page scroll bar under a certain screen width\r\n    if (window.innerWidth < 620) {\r\n      document.body.style.overflowY = 'hidden';\r\n    };\r\n    // Unhide navSearchBtnClearX if there is text inside the input field\r\n    if (navSearchInputTxt.value !== \"\") {\r\n      navSearchBtnClearX.style.display = \"flex\";\r\n    }\r\n    (0,_wsi_js__WEBPACK_IMPORTED_MODULE_0__.wsiOpenOrAccessSharedSocket)();\r\n    searchQuery()\r\n  }\r\n\r\n  function hideSearchControl() {\r\n    navSearchIconLoupe.style.display = \"none\";\r\n    navSearchBoxDiv2.style.marginLeft = '25px';\r\n    navSearchBoxDiv2.style.paddingLeft = '0';\r\n    navSearchBoxDiv2.style.border = '1px solid var(--color-searchbutton)';\r\n    navSearchResDiv0.style.display = 'none';\r\n    if (!window.matchMedia('(min-width: ' + screenWidthLg + 'px)').matches) {\r\n      navSearchMain.style.display = \"none\";\r\n    };\r\n    navSearchInputTxt.blur();\r\n    navSearchTriggerBtn.setAttribute('aria-expanded', 'false');\r\n    document.body.style.overflowY = 'auto';\r\n  };\r\n\r\n  /////////////////////////////////////////////////////////////////////////////////\r\n  //  Event listeners\r\n  /////////////////////////////////////////////////////////////////////////////////\r\n  function handleInputTextChange(event) {\r\n    // Unhide navSearchBtnClearX if there is text inside the input field\r\n    if (this.value !== \"\") {\r\n      navSearchBtnClearX.style.display = \"flex\";\r\n    } else {\r\n      // Hide navSearchBtnClearX if the input field is empty\r\n      navSearchBtnClearX.style.display = \"none\";\r\n    };\r\n    searchQuery();\r\n  }\r\n  navSearchInputTxt.addEventListener('input', handleInputTextChange);\r\n\r\n  function handlePreventXbuttonFocusLoss(event) {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n  }\r\n  navSearchBtnClearX.addEventListener('mousedown', handlePreventXbuttonFocusLoss);\r\n\r\n  function handleClickOnXbutton(event) {\r\n    navSearchInputTxt.value = \"\";\r\n    navSearchInputTxt.focus();\r\n    navSearchBtnClearX.style.display = \"none\";\r\n    searchQuery();\r\n  };\r\n  navSearchBtnClearX.addEventListener('mouseup', handleClickOnXbutton);\r\n\r\n  function handlePreventLeavingInput(event) {\r\n    if (event.target !== navSearchInputTxt) {\r\n      event.preventDefault();\r\n    };\r\n  };\r\n  navSearchMain.addEventListener('mousedown', handlePreventLeavingInput);\r\n\r\n  function handleScrollingFromMainCtn(event) {\r\n    let delta = Math.max(-1, Math.min(1, (event.wheelDelta || -event.detail)));\r\n    navSearchResDiv0.scrollTop -= (delta * 30);\r\n    event.preventDefault();\r\n  }\r\n  navSearchMain.addEventListener('wheel', handleScrollingFromMainCtn);\r\n\r\n  function handleClickedOutside(event) {\r\n    let clickedOnScrollbar = document.documentElement.clientWidth <= event.clientX;\r\n    if (!clickedOnScrollbar &&\r\n      !navSearchMain.contains(event.target) &&\r\n      !navSearchResDiv0.contains(event.target) &&\r\n      !navSearchTriggerBtn.contains(event.target)) {\r\n      // The click occurred outside of both elements\r\n      hideSearchControl();\r\n    };\r\n  };\r\n  document.addEventListener('mousedown', handleClickedOutside);\r\n\r\n  function handleEscapeKeydown(event) {\r\n    if (event.key === 'Escape') {\r\n      hideSearchControl();\r\n    };\r\n  };\r\n  document.addEventListener('keydown', handleEscapeKeydown);\r\n\r\n  function handleBackButtonClick(event) {\r\n    hideSearchControl();\r\n  };\r\n  navSearchBtnBack.addEventListener(\"click\", (0,_base_js__WEBPACK_IMPORTED_MODULE_1__.throttle)(handleBackButtonClick, 1000));\r\n\r\n  navSearchInputTxt.addEventListener(\"mousedown\", function() {\r\n    if (navSearchTriggerBtn.getAttribute('aria-expanded') === 'false') {\r\n      showSearchControl();\r\n    };\r\n  });\r\n\r\n  navSearchBtnEnter.addEventListener(\"click\", (0,_base_js__WEBPACK_IMPORTED_MODULE_1__.throttle)(function() {\r\n    console.log(\"search button click\");\r\n  }, 1000));\r\n\r\n  navSearchTriggerBtn.addEventListener('click', function() {\r\n    if (navSearchTriggerBtn.getAttribute('aria-expanded') === 'false') {\r\n      showSearchControl();\r\n    } else if (navSearchTriggerBtn.getAttribute('aria-expanded') === 'true') {\r\n      hideSearchControl();\r\n    };\r\n  });\r\n\r\n  /////////////////////////////////////////////////////////////////////////////////\r\n  // Change the display based on windows width\r\n  /////////////////////////////////////////////////////////////////////////////////\r\n\r\n  function setSearchBoxDisplayPerScreenWidth() {\r\n    if (window.matchMedia('(min-width: ' + screenWidthLg + 'px)').matches) {\r\n      navSearchMain.style.display = \"block\";\r\n    } else {\r\n      if (navSearchMain.style.display == \"block\" &&\r\n        navSearchResDiv0.style.display == \"none\") {\r\n        navSearchMain.style.display = \"none\";\r\n      };\r\n    };\r\n  };\r\n  navSearchMain.style.display = \"none\";\r\n  navSearchResDiv0.style.display = \"none\";\r\n  setSearchBoxDisplayPerScreenWidth();\r\n\r\n  window.addEventListener('resize', function() {\r\n    setSearchBoxDisplayPerScreenWidth();\r\n  });\r\n\r\n  /////////////////////////////////////////////////////////////////////////////////\r\n  //  Show results from received data\r\n  /////////////////////////////////////////////////////////////////////////////////\r\n\r\n  function showSearchResults(fullDict) {\r\n    let query = fullDict[\"q\"];\r\n    let resultArray = fullDict[\"r\"];\r\n    let ul = document.createElement(\"ul\");\r\n    // ul.innerHTML = query\r\n    for (let i = 0; i < resultArray.length; i++) {\r\n      let li = document.createElement(\"li\");\r\n      li.innerHTML = resultArray[i].title + \" (\" + resultArray[i].vote + \")\";\r\n      ul.appendChild(li);\r\n    };\r\n    navSearchResDiv0.innerHTML = \"\";\r\n    navSearchResDiv0.appendChild(ul);\r\n    // console.log(\"show\")\r\n  };\r\n\r\n  /////////////////////////////////////////////////////////////////////////////////\r\n  //    previous search remembering to avoid sending a query\r\n  /////////////////////////////////////////////////////////////////////////////////\r\n\r\n  let previousSearches = []; // array of dicts\r\n\r\n  function getPreviousSearchResult(query) {\r\n    let index = previousSearches.findIndex(dict => dict[\"q\"] === query);\r\n    if (index !== -1) {\r\n      return previousSearches[index]\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  function setPreviousSearchResult(jsonObject) {\r\n    let dict = JSON.parse(jsonObject);\r\n    let query = dict[\"q\"];\r\n    if (!previousSearches.some(dict => dict[\"q\"] === query)) {\r\n      // Add newElement at index 1 and push the others to the right, keep element 0\r\n      previousSearches.splice(1, 0, dict);\r\n      if (previousSearches.length > 50) {\r\n        array.pop();\r\n      }\r\n    }\r\n  }\r\n\r\n  /////////////////////////////////////////////////////////////////////////////////\r\n  //    send search query logic\r\n  /////////////////////////////////////////////////////////////////////////////////\r\n\r\n  function makeSearchQuery() {\r\n    let query = navSearchInputTxt.value;\r\n    let existingSearch = getPreviousSearchResult(query);\r\n    if (existingSearch == null) {\r\n      navSearchStartTimer = performance.now();\r\n      (0,_wsi_js__WEBPACK_IMPORTED_MODULE_0__.wsiSend)('s' + _wsi_js__WEBPACK_IMPORTED_MODULE_0__.wsiCurrentTabId + query);\r\n    } else {\r\n      showSearchResults(existingSearch);\r\n    }\r\n  }\r\n\r\n  const searchQuery = debounce_search(makeSearchQuery, 400);\r\n\r\n  function debounce_search(func, delay) {\r\n    let lastCallTime = 0;\r\n    let timeoutId;\r\n\r\n    return function() {\r\n      const context = this;\r\n      const args = arguments;\r\n      const now = Date.now();\r\n\r\n      clearTimeout(timeoutId);\r\n\r\n      if (now - lastCallTime < delay) {\r\n        timeoutId = setTimeout(() => {\r\n          lastCallTime = Date.now();\r\n          func.apply(context, args);\r\n        }, delay - (now - lastCallTime));\r\n      } else {\r\n        lastCallTime = now;\r\n        func.apply(context, args);\r\n      };\r\n    };\r\n  };\r\n\r\n  function wsiToSearchReceivedResult(jsonObject) {\r\n    setPreviousSearchResult(jsonObject);\r\n    showSearchResults(JSON.parse(jsonObject));\r\n  }\r\n\r\n  /////////////////////////////////////////////////////////////////////////////////\r\n  //    exported functions (through the main function)\r\n  /////////////////////////////////////////////////////////////////////////////////\r\n  return {\r\n    makeSearchQuery: makeSearchQuery,\r\n    wsiToSearchReceivedResult: wsiToSearchReceivedResult\r\n  };\r\n};\r\n\r\n/////////////////////////////////////////////////////////////////////////////////\r\n//    \r\n/////////////////////////////////////////////////////////////////////////////////\n\n//# sourceURL=webpack://zap/../cjs/search.js?");

/***/ }),

/***/ "../cjs/wsi.js":
/*!*********************!*\
  !*** ../cjs/wsi.js ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   wsiCurrentTabId: () => (/* binding */ wsiCurrentTabId),\n/* harmony export */   wsiOpenOrAccessSharedSocket: () => (/* binding */ wsiOpenOrAccessSharedSocket),\n/* harmony export */   wsiReconnect: () => (/* binding */ wsiReconnect),\n/* harmony export */   wsiSend: () => (/* binding */ wsiSend)\n/* harmony export */ });\n/* harmony import */ var _search_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./search.js */ \"../cjs/search.js\");\n/* harmony import */ var _filespro_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./filespro.js */ \"../cjs/filespro.js\");\n\r\n\r\n\r\n\r\n/////////////////////////////////////////////////////////////////////////////////\r\n//    check whether to load search\r\n/////////////////////////////////////////////////////////////////////////////////\r\nif (document.querySelector('.navSearchMain')) {\r\n  var searchFunctions = (0,_search_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(); // keep at var so it goes in the module top level\r\n};\r\n\r\n/////////////////////////////////////////////////////////////////////////////////\r\n//    check whether to load filespro\r\n/////////////////////////////////////////////////////////////////////////////////\r\nif (document.querySelector('.fileUploadSendBtn') ||\r\n  document.querySelector('.fileUploadSendAvatarBtn')) {\r\n  var fileUploadFunctions = (0,_filespro_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(); // keep at var so it goes in the module top level\r\n};\r\n\r\n/////////////////////////////////////////////////////////////////////////////////\r\n//    wsi\r\n/////////////////////////////////////////////////////////////////////////////////\r\n// localStorage of the browser is used to store the last tabId in a single char\r\n// get the next wsiCurrentTabId in storage, single character\r\nlet wsiCurrentTabId = localStorage.getItem('wsiCurrentTabId');\r\nif (wsiCurrentTabId !== null) {\r\n  let nextTabId = wsiCurrentTabId.charCodeAt(0) + 1;\r\n  //   33; // '!' to  126; // '~'\r\n  if (nextTabId > 126) {\r\n    nextTabId = 33;\r\n  };\r\n  localStorage.setItem('wsiCurrentTabId', String.fromCharCode(nextTabId));\r\n} else {\r\n  wsiCurrentTabId = String.fromCharCode(33);\r\n  localStorage.setItem('wsiCurrentTabId', wsiCurrentTabId);\r\n};\r\n\r\nfunction handleWsEvent(event) {\r\n  switch (event.type) {\r\n    case 'onopen':\r\n      console.log('WebSocket is open');\r\n      if (typeof fileUploadFunctions !== 'undefined') {\r\n        fileUploadFunctions.askForListOfFiles();\r\n      };\r\n      if (typeof searchFunctions !== 'undefined') {\r\n        searchFunctions.makeSearchQuery();\r\n      };\r\n      break;\r\n    case 'onclose':\r\n      console.log('WebSocket is closed');\r\n      break;\r\n    case 'onerror':\r\n      console.log('WebSocket encountered an error');\r\n      break;\r\n    case 'onmessage':\r\n      console.log('WSI Received message:', event.data);\r\n      if (event.data.length > 2) {\r\n        let message = event.data.substring(2);\r\n        if (event.data[1] == wsiCurrentTabId) {\r\n          switch (event.data[0]) {\r\n            case 's':\r\n              // check if the module is loaded\r\n              if (typeof searchFunctions !== 'undefined') {\r\n                searchFunctions.wsiToSearchReceivedResult(message);\r\n              };\r\n            case 'f':\r\n              if (typeof fileUploadFunctions !== 'undefined') {\r\n                fileUploadFunctions.wsiToFilesproMessageReceived(message);\r\n              };\r\n          };\r\n        };\r\n      };\r\n      break;\r\n    default:\r\n  };\r\n};\r\n\r\nconst websocketUrl = (window.location.protocol === 'https:' ? 'wss://' : 'ws://') +\r\n  window.location.host + '/wsi/';\r\nlet wsworker;\r\nlet gsocket;\r\nlet useSharedWorker = !!window.SharedWorker; // is supported\r\n\r\nfunction wsiOpenOrAccessSharedSocket() {\r\n  if (typeof wsworker === 'undefined') {\r\n    console.log(\"Opening web socket\")\r\n    if (useSharedWorker) {\r\n      wsworker = new SharedWorker('/static/js/sharedWorker.js');\r\n\r\n      wsworker.port.onmessage = function(e) {\r\n        handleWsEvent(e.data);\r\n      };\r\n\r\n      wsworker.port.start();\r\n\r\n      wsworker.port.postMessage({\r\n        command: 'connect',\r\n        url: websocketUrl\r\n      });\r\n    } else {\r\n      initiateWebsocketFallback();\r\n    };\r\n    window.addEventListener('beforeunload', function() {\r\n      if (useSharedWorker) {\r\n        wsworker.port.postMessage({\r\n          command: 'removePort'\r\n        });\r\n      } else {\r\n        gsocket.close();\r\n      };\r\n    });\r\n  };\r\n};\r\n\r\nfunction initiateWebsocketFallback() {\r\n  gsocket = new WebSocket(websocketUrl);\r\n\r\n  gsocket.onopen = function() {\r\n    handleWsEvent({\r\n      type: 'onopen'\r\n    });\r\n  };\r\n\r\n  gsocket.onmessage = function(e) {\r\n    handleWsEvent({\r\n      type: 'onmessage',\r\n      data: e.data\r\n    });\r\n  };\r\n\r\n  gsocket.onerror = function() {\r\n    handleWsEvent({\r\n      type: 'onerror'\r\n    });\r\n  };\r\n\r\n  gsocket.onclose = function() {\r\n    handleWsEvent({\r\n      type: 'onclose'\r\n    });\r\n  };\r\n};\r\n\r\nfunction wsiSend(message) {\r\n  if (useSharedWorker) {\r\n    wsworker.port.postMessage({\r\n      command: 'send',\r\n      message: message\r\n    });\r\n  } else if (gsocket && gsocket.readyState === WebSocket.OPEN) {\r\n    gsocket.send(message);\r\n  };\r\n  message.length < 100 ? console.log(\"WSI Sending: \" + message) : null;\r\n};\r\n\r\nfunction wsiReconnect() {\r\n  if (useSharedWorker) {\r\n    wsworker.port.postMessage({\r\n      command: 'reconnect',\r\n      url: websocketUrl\r\n    });\r\n  } else if (gsocket && gsocket.readyState === WebSocket.OPEN) {\r\n    gsocket.close();\r\n    gsocket = null;\r\n    initiateWebsocketFallback();\r\n  };\r\n};\n\n//# sourceURL=webpack://zap/../cjs/wsi.js?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module is referenced by other modules so it can't be inlined
/******/ 	__webpack_require__("../cjs/base.js");
/******/ 	__webpack_require__("../cjs/wsi.js");
/******/ 	__webpack_require__("../cjs/search.js");
/******/ 	var __webpack_exports__ = __webpack_require__("../cjs/filespro.js");
/******/ 	
/******/ })()
;